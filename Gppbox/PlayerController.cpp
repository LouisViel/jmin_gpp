#include "PlayerController.hpp"
#include "Entity.hpp"
#include "C.hpp"

PlayerController::PlayerController(Entity* entity) : Component(entity) { }


//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////


void PlayerController::preupdate(double dt)
{
	// Update Coyotee Timer
	if (!entity->isGrounded && coyoteeTime > 0.0f) {
		coyoteeTime -= dt;
	}

	// Update Jump Delay Timer
	if (jumpDelay > 0.0f) {
		jumpDelay -= dt;
	}
}

void PlayerController::fixed(double fdt) { }

void PlayerController::update(double dt) { }


//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////


void PlayerController::draw(sf::RenderWindow& win) { }

bool PlayerController::imgui() { return false; }


//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////


void PlayerController::onGrounded(bool state)
{
	if (state) {
		coyoteeTime = C::P_COYOTEE;
		jumpDelay = C::P_JUMPD;
	}
}

void PlayerController::onJumping(bool state)
{
	if (state) {
		coyoteeTime = 0.0f;
	}
}

bool PlayerController::canJump()
{
	return jumpDelay <= 0.0f && coyoteeTime > 0.0f;
}